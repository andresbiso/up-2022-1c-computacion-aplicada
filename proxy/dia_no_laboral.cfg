# Generated by iptables-save v1.8.7 on Tue Jun 21 19:41:34 2022
# Los siguientes comandos corresponden a la tabla Filter
*filter
# Desactivo todas las entradas, salidas y redireccionamientos antes de realizar cualquier cambio
:INPUT DROP [30:3541]
:FORWARD DROP [0:0]
:OUTPUT DROP [16:1136]

# Activar entrada de paquetes por el puerto 22 que es el puerto por defecto de SSH 
# -s SOURCE Es la IP de origen de los paquetes que en este caso se esta dando de alta
# -p PROTOCOL Es el protocolo, en este caso el TCP
# -m MODULE En este caso también TCP
# -dport Es el Puerto de destino del paquete, en este caso 22 por SSH
-A INPUT -s 192.168.1.10/32 -p tcp -m tcp --dport 22 -j ACCEPT
# Activar la entrada de paquetes
-A INPUT -i lo -j ACCEPT


# Redireccionar los mismos a la placa enp0s3
# FOWARD Redireccionar
# -s Source
# -d Destination
# -I es la placa de red de origen
# -o es la placa de red de salida
# ACCEPT Aceptar los paquetes
-A FORWARD -s 192.168.1.10/32 -i enp0s8 -o enp0s3 -j ACCEPT
-A FORWARD -d 192.168.1.55/32 -i enp0s3 -o enp0s8 -j ACCEPT


# Activar la salida de paquetes por el puerto 22 que es el puerto por defecto de SSH
# OUTPUT Salida de paquetes
# -s SOURCE Es la IP de origen de los paquetes que en este caso se está dando de alta
# -p PROTOCOL Es el protocolo, en este caso el TCP
# -m MODULE En este caso también TCP
# -dport Es el Puerto de destino del paquete, en este caso 22 por SSH
# -state El modo que se relaciona el paquete, en este caso ESTABLISHED significa por medio de una conexión establecida
-A OUTPUT -d 192.168.1.10/32 -p tcp -m tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT
-A OUTPUT -o lo -j ACCEPT

# Commit de aceptacion de los cambios
COMMIT
# Completed on Tue Jun 21 19:41:34 2022
# Generated by iptables-save v1.8.7 on Tue Jun 21 19:41:34 2022



# Los siguientes comandos corresponden a la tabla Nat
*nat

#Da de alta la entrada las conexiones en la tabla Nat
:PREROUTING ACCEPT [1794:148267]
:INPUT ACCEPT [26:2106]
:OUTPUT ACCEPT [241:46152]

# Para permitir que navegue por internet se necesita Enmascarar los paquetes
:POSTROUTING ACCEPT [0:0]
-A POSTROUTING -s 192.168.1.10/32 -j MASQUERADE

# Commit de aceptacion de los cambios
COMMIT
# Completed on Tue Jun 21 19:41:34 2022
